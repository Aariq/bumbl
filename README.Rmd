---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# Tools for modeling bumblebee colony growth

<!-- badges: start -->
[![R build status](https://github.com/Aariq/bumbl/workflows/R-CMD-check/badge.svg)](https://github.com/Aariq/bumbl/actions)
[![Codecov test coverage](https://codecov.io/gh/Aariq/bumbl/branch/master/graph/badge.svg)](https://codecov.io/gh/Aariq/bumbl?branch=master)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/bumbl)](https://CRAN.R-project.org/package=bumbl)

<!-- badges: end -->

`bumbl` implements a model for bumblebee colony growth described in Crone and Williams 2016^1^. The `brkpt` function models colony growth as having a change point at some time, *tau*, where the colony switches from growth and worker production to gyne production.  The `bumbl` function applies this model to a data frame of data from multiple colonies, allowing for each colony to have it's own *tau* and returns the original data augmented with coefficients from the changepoint model.

This is still in very early development, so use at your own risk.

## Roadmap

- [x] Write `bumbl()` function to model colony growth with switchpoint
- [x] Finish documentation and vignette(s)
- [ ] [rOpenSci review](https://github.com/ropenscilabs/statistical-software-review/issues/2)
- [ ] Initial CRAN submission
- [ ] Add integral projection model functions (in development on [ipm branch](https://github.com/Aariq/bumbl/tree/ipm))
- [ ] Submit new major verson to CRAN

After this, I'm probably going to be looking for someone else to take over maintenance and development.  In the meantime, I welcome contributions including bug-fixes, improvement of documentation, additional features, or new functions relating to bumblebee ecology and demography.

Possible areas of improvement that I don't personally have time for:

- Extend `bumbl()` to work with GLMMs
- Better optimization function for finding the switchpoint in `bumbl()` (for inspiration, see [changepoint](https://github.com/rkillick/changepoint/))

## Installation

You can install this development version of `bumbl` with:

``` r
devtools::install_github("Aariq/bumbl", build_vignettes = TRUE)
```

## Getting started

View the package vignette with:

``` r
library(bumbl)
vignette("bumbl")
```
```{r include=FALSE}
# library(bumbl)
devtools::load_all()
```

View the `bomubs` dataset

```{r}
head(bombus)
```

### Example use

Using a subset of the `bombus` dataframe to estimate the week (tau) that colonies switch to reproduction

```{r}
bombus2 <- bombus[bombus$colony %in% c(9, 82, 98, 35), ]
results <- bumbl(bombus2, colonyID = colony, t = week, formula = d.mass ~ week)
results
```

Plot the results

```{r}
par(mfrow = c(2, 2))
plot(results)
par(mfrow = c(1, 1))
```


# References
^1^Crone, E. E., and Williams, N. M. (2016). Bumble bee colony dynamics: quantifying the importance of land use and floral resources for colony growth and queen production. Ecol. Lett. 19, 460â€“468. https://doi.org/10.1111/ele.12581


---


Please note that the bumbl project is released with a
[Contributor Code of Conduct](CODE_OF_CONDUCT.md). By contributing to this
project you agree to abide by its terms.

